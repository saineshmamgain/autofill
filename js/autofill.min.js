var options_default={onSelect:function(b,a){},onChange:function(b,a){},onFocusIn:function(){}};
$.fn.autofill=function(b){void 0==b&&(b=options_default);var a=$(this),c=a.attr("id"),d=a.data("autofill"),f=a.position(),h=$("<ul>"),e="autofill_list_"+c,g="",k="";h.attr({id:e,"data-target":c,"class":"autofill-show"});h.css({width:a.width()+parseInt(a.css("padding-left"),10)+parseInt(a.css("padding-right"),10),position:"absolute",top:b.top?b.top:f.top+a.outerHeight(),left:-99999});$("#"+c).on("keyup",function(a){g="";var c=$(this).val();c.length&&$.grep(d,function(d){try{-1!==d.label.search(new RegExp(c,
    "i"))&&($.each(d,function(b,a){k+=" data-"+b+'="'+a+'" '}),g+='<li class="autofill-list"'+k+">"+d.label+"</li>",$(a.target).trigger("onChange",[c,d,b]),k="")}catch(f){$("#"+e).css("left",-99999)}});$("#"+e).html(g).css("left",b.left?b.left:f.left);6<=$("#"+e).find("li").length&&$("#"+e).css({height:"130px","overflow-y":"scroll"})}).on("focus",function(a){g="";$(this).val("");$.each(d,function(a,b){$.each(b,function(b,a){k+=" data-"+b+'="'+a+'" '});g+='<li class="autofill-list"'+k+">"+b.label+"</li>";
    k=""});$("#"+e).html(g).css("left",b.left?b.left:f.left);6<=$("#"+e).find("li").length&&$("#"+e).css({height:"130px","overflow-y":"scroll"});$(a.target).trigger("onFocusIn",[b]);$(a.target).trigger("onChange",["",{},b])});a.after(h);$("#"+e).html(g);$(document).on("click",function(a){$(a.target).hasClass("autofill-list")&&$(a.target).parent("ul").data("target")==c?$(a.target).trigger("onSelect",[$(a.target).text(),$(a.target).data(),$(a.target).parent("ul"),$(a.target).parent("ul").data("target"),
    b]):$(a.target).attr("id")!==c&&$("#"+e).trigger("close")})};$(document).on("onSelect",".autofill-list",function(b,a,c,d,f,h){$("#"+f).val(a);$(d).css("left",-99999);if($.isFunction(h.onSelect))h.onSelect(c)});$(document).on("onFocusIn",function(b,a){if($.isFunction(a.onFocusIn))a.onFocusIn()});$(document).on("onChange",function(b,a,c,d){if($.isFunction(d.onChange)){var f=new RegExp("^"+a+"$","gi");b=$(c).filter(function(a,b){return f.test(b.label)}).get();d.onChange(a,c,b[0]?b[0]:{})}});
$(document).on("close",function(b){$(b.target).css("left",-99999)});