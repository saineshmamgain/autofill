var options_default={onSelect:function(b,a){},onChange:function(b,a){},onFocusIn:function(){}};
$.fn.autofill=function(b){void 0==b&&(b=options_default);var a=$(this),c=a.attr("id"),e=a.data("autofill"),f=a.position(),d=$("<ul>"),h="autofill_list_"+c,g="",k="";d.attr({id:h,"data-target":c,"class":"autofill-show"});d.css({width:a.width()+parseInt(a.css("padding-left"),10)+parseInt(a.css("padding-right"),10),position:"absolute",top:f.top+a.outerHeight(),left:-99999});6<=d.find("li").length&&d.css({height:"130px","overflow-y":"scroll"});$("#"+c).on("keyup",function(a){g="";var c=$(this).val();
    c.length&&$.grep(e,function(d){try{-1!==d.label.search(new RegExp(c,"i"))&&($.each(d,function(a,b){k+=" data-"+a+'="'+b+'" '}),g+='<li class="autofill-list"'+k+">"+d.label+"</li>",$(a.target).trigger("onChange",[c,d,b]),k="")}catch(e){$("#"+h).css("left",-99999)}});$("#"+h).html(g).css("left",f.left)}).on("focus",function(a){g="";$(this).val("");$.each(e,function(a,b){$.each(b,function(a,b){k+=" data-"+a+'="'+b+'" '});g+='<li class="autofill-list"'+k+">"+b.label+"</li>";k=""});$("#"+h).html(g).css("left",
    f.left);$(a.target).trigger("onFocusIn",[b]);$(a.target).trigger("onChange",["",{},b])});a.after(d);$("#"+h).html(g);$(document).on("click",function(a){$(a.target).hasClass("autofill-list")&&$(a.target).parent("ul").data("target")==c?$(a.target).trigger("onSelect",[$(a.target).text(),$(a.target).data(),$(a.target).parent("ul"),$(a.target).parent("ul").data("target"),b]):$(a.target).attr("id")!==c&&$("#"+h).trigger("close")})};
$(document).on("onSelect",".autofill-list",function(b,a,c,e,f,d){$("#"+f).val(a);$(e).css("left",-99999);if($.isFunction(d.onSelect))d.onSelect(c)});$(document).on("onFocusIn",function(b,a){if($.isFunction(a.onFocusIn))a.onFocusIn()});$(document).on("onChange",function(b,a,c,e){if($.isFunction(e.onChange)){var f=new RegExp("^"+a+"$","gi");b=$(c).filter(function(a,b){return f.test(b.label)}).get();e.onChange(a,c,b[0]?b[0]:{})}});$(document).on("close",function(b){$(b.target).css("left",-99999)});