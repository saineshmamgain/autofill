try{jQuery.fn.autofill=function(a){var b=jQuery,g={onSelect:function(b){},onChange:function(b,a,l){},onFocusIn:function(){},render:function(a){var d="",l="";b(a).each(function(a,f){b.each(f,function(b,a){d+=" data-"+b+'="'+a+'" '});l+='<li class="autofill-list"'+d+">"+f.label+"</li>";d=""});return l},minScroll:6,minScrollHeight:"100px"};void 0===a&&(a=g);var m=!0,e=b(this);if(e.attr("id"))var k=e.attr("id");else k="autofiil_input_"+(new Date).getTime(),e.attr("id",k);b(document).on("autofillDataReceived",
    "#"+k,function(c,d){var l=e.position(),p=b("<ul>"),f="autofill_list_"+k,h="",q=[];p.attr({id:f,"data-target":k,"class":"autofill-show"});p.css({width:e.width()+parseInt(e.css("padding-left"),10)+parseInt(e.css("padding-right"),10),position:"absolute",top:a.top?a.top:l.top+e.outerHeight(),left:-99999});m&&(b("#"+k).on("keyup",function(r){var c=b(this).val();if(c.length){if(void 0===q[c]){var e=b.grep(d,function(d){try{if(-1!==d.label.search(new RegExp(c,"i")))return b(r.target).trigger("onChange",
        [c,d,a]),d}catch(t){b("#"+f).css("left",-99999)}});q[c]=e}else e=q[c],b(r.target).trigger("onChange",[c,e,a]);if(a.render||g.render)h=b.isFunction(a.render)?a.render(e):g.render(e)}else if(a.render||g.render)h=b.isFunction(a.render)?a.render(d):g.render(d);b("#"+f).html(h).css("left",a.left?a.left:l.left);b("#"+f).find("li").length>=(a.minScroll?a.minScroll:g.minScroll)?b("#"+f).css({height:a.minScrollHeight?a.minScrollHeight:g.minScrollHeight,"overflow-y":"scroll"}):b("#"+f).css({height:"auto","overflow-y":"unset"})}).on("focus",
        function(c){h="";b(this).val("");if(a.render||g.render)h=b.isFunction(a.render)?a.render(d):g.render(d);b("#"+f).html(h).css("left",a.left?a.left:l.left);b("#"+f).find("li").length>=(a.minScroll?a.minScroll:g.minScroll)?b("#"+f).css({height:a.minScrollHeight?a.minScrollHeight:g.minScrollHeight,"overflow-y":"scroll"}):b("#"+f).css({height:"auto","overflow-y":"unset"});b(c.target).trigger("onFocusIn",[a]);b(c.target).trigger("onChange",["",{},a])}),e.after(p),b("#"+f).html(h),b(document).on("click",
        function(c){"li"===c.target.tagName.toLowerCase()&&b(c.target).parent("ul").data("target")==k?b(c.target).trigger("onSelect",[b(c.target).text(),b(c.target).data(),b(c.target).parent("ul"),b(c.target).parent("ul").data("target"),a]):b(c.target).attr("id")!==k&&b("#"+f).trigger("close")}))});if(a.source&&void 0!==a.ajax&&!0===a.ajax)m=!1,b.ajax({url:a.source,type:"GET",success:function(a){m=!0;n=a;b("#"+k).trigger("autofillDataReceived",[n])},error:function(){m=!1;throw Error("There was an error fetching data from server.");
}});else{if(void 0!==a.source){m=!0;var n=JSON.parse(a.source)}else m=!0,n=e.data("autofill");b("#"+k).trigger("autofillDataReceived",[n])}b(document).on("onSelect","li",function(a,d,e,g,f,h){b("#"+f).val(d);b(g).css("left",-99999);if(b.isFunction(h.onSelect))h.onSelect(e)});b(document).on("onFocusIn",function(a,d){if(b.isFunction(d.onFocusIn))d.onFocusIn()});b(document).on("onChange",function(a,d,e,g){if(b.isFunction(g.onChange)){var c=new RegExp("^"+d+"$","gi");a=b(e).filter(function(b,a){return c.test(a.label)}).get();
    g.onChange(d,e,a[0]?a[0]:{})}});b(document).on("close",function(a){b(a.target).css("left",-99999)})}}catch(a){console.error(a)};